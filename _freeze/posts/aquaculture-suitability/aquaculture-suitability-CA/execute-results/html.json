{
  "hash": "0d3b38c6b48151a55c8459a39bd20ac1",
  "result": {
    "markdown": "---\ntitle: \"Aquaculture Suitability in West Coast Exclusive Economic Zones\"\ndescription: \"Assessing viability of aquaculture for different aquatic species on the West Coast of the US\"\nauthor:\n  - name: Charlie Curtin\n    affiliation: Master of Environmental Data Science Program\n    affiliation-url: https://ucsb-meds.github.io/\ndate: 12-15-2023\nimage: aquaculture.png\nformat: \n      html: \n          code-fold: true\n---\n\n\n\n\nGithub: <https://github.com/charliecurtin1/aquaculture-suitability-CA>\n\n## Overview\n\nMarine aquaculture has the potential to play an important role in the global food supply as a more sustainable protein option than land-based meat production.[^1] [Gentry et al.](https://www.nature.com/articles/s41559-017-0257-9) mapped the potential for marine aquaculture globally based on multiple constraints, including ship traffic, dissolved oxygen, and bottom depth .[^2]\n\n[^1]: Hall, S. J., Delaporte, A., Phillips, M. J., Beveridge, M. & O'Keefe, M. Blue Frontiers: Managing the Environmental Costs of Aquaculture (The WorldFish Center, Penang, Malaysia, 2011).\n\n[^2]: Gentry, R. R., Froehlich, H. E., Grimm, D., Kareiva, P., Parke, M., Rust, M., Gaines, S. D., & Halpern, B. S. Mapping the global potential for marine aquaculture. *Nature Ecology & Evolution*, 1, 1317-1324 (2017).\n\nAquaculture doesn't only serve to enhance food supply directly, however. Beyond commercial aquaculture, the West Coast of the US contains potential for restoration and enhancement aquaculture. NOAA Fisheries^3^ describes restoration aquaculture as the rearing of fish to increase stock of threatened or endangered species, and enhancement aquaculture as the rearing of fish to support commercial or recreational fisheries through the increasing of fish stock.\n\nFor this analysis, we will determine which Exclusive Economic Zones (EEZ) on the West Coast of the US are best suited to developing marine aquaculture for several species of oysters.\\\n\nBased on previous research, we know that oysters needs the following conditions for optimal growth:\\\n\n-   sea surface temperature: 11-30Â°C\\\n-   depth: 0-70 meters below sea level\n\n##### Analysis highlights:\n\n-   combining vector/raster data\\\n-   resampling raster data\\\n-   masking raster data\\\n-   map algebra\\\n\n### Data\n\n#### Sea Surface Temperature\n\nWe will use average annual sea surface temperature (SST) from the years 2008 to 2012 to characterize the average sea surface temperature within the region. The data we are working with was originally generated from [NOAA's 5km Daily Global Satellite Sea Surface Temperature Anomaly v3.1](https://coralreefwatch.noaa.gov/product/5km/index_5km_ssta.php).\n\n#### Bathymetry\n\nTo characterize the depth of the ocean we will use the [General Bathymetric Chart of the Oceans (GEBCO)](https://www.gebco.net/data_and_products/gridded_bathymetry_data/#area).[^3]\n\n[^3]: GEBCO Compilation Group (2022) GEBCO_2022 Grid (<doi:10.5285/e0f0bb80-ab44-2739-e053-6c86abc0289c>).\n\n#### Exclusive Economic Zones\n\nWe will be designating maritime boundaries using Exclusive Economic Zones off of the west coast of US from [Marineregions.org](https://www.marineregions.org/eez.php).\n\n## Workflow\n\nBelow is an outline of the steps in this workflow.\n\n#### Prepare data\n\nTo start, we need to load all necessary data and make sure they have the same coordinate reference system. We'll reproject any layers not on the same coordinate reference system.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load required packages\nlibrary(stars)\nlibrary(sf)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(terra)\nlibrary(raster)\nlibrary(here)\nlibrary(tmap)\nlibrary(usmap)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## read in data\n# create a filelist of sea surface temperature rasters\nfilelist <- list.files(here(\"posts\", \"aquaculture-suitability\", \"data\"), \n                       pattern = \"average_annual*\", \n                       full.names = TRUE)\n\n# create a raster stack of SST rasters\nsst_stack <- rast(filelist)\n\n# read in west coast EEZ shapefile\nwc_eez <- st_read(here(\"posts\", \"aquaculture-suitability\", \"data\", \"wc_regions_clean.shp\"), quiet = TRUE)\n\n# read in bathymetry data\ndepth <- rast(here(\"posts\", \"aquaculture-suitability\", \"data\", \"depth.tif\")) \n```\n:::\n\n\n#### Process data\n\nNext, we need process the SST and depth data so that they can be combined. In this case the SST and depth data have slightly different resolutions, extents, and positions. We don't want to change the underlying depth data, so we will need to resample to match the SST data using the nearest neighbor approach. We'll stack the rasters and find the mean sea surface temperature from 2008-2012 and convert values from Kelvin to Celsius using simple raster arithmetic. Next, we'll use `terra::project()` to crop and change the extent of the depth raster to the SST raster.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# find the mean SST from 2008-2012 as a new raster\nmean_sst <- app(sst_stack,\n                fun = \"mean\",\n                na.rm = TRUE)\n\n# convert the mean SST raster from Kelvin to Celsius\nmean_sst <- mean_sst - 273.15\n\n# crop the depth raster to the extent of the sst data and resample so that the resolutions match\ndepth <- project(depth, mean_sst,\n                 method = \"near\")\n```\n:::\n\n\n#### Find suitable locations (20)\n\nIn order to find suitable locations for marine aquaculture, we'll need to find locations that are suitable in terms of both SST and depth. We'll reclassify the depth and SST rasters according to ideal oyser depth and temperature ranges. Suitable cells will be reclassified to have a value of 1, while cells outside of the ranges will have a value of `NA`. Then, we'll multiply the two rasters together. Cells that satisfy both the depth and SST ranges will receive a value of 1, while all other pixels will receive a value of `NA`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## find suitable locations for oyster aquaculture by reclassifying the depth and SST rasters\n# create matrices of ideal ranges for depth and SST to reclassify rasters\nrcl_sst <- matrix(c(11, 30, 1,\n                     -Inf, 11, NA,\n                     30, Inf, NA),\n                   ncol = 3,\n                   byrow = TRUE)\n\nrcl_depth <- matrix(c(-70, 0, 1,\n                      -Inf, -70, NA,\n                      0, Inf, NA),\n                    ncol = 3,\n                    byrow = TRUE)\n\n# reclassify the rasters based on ideal conditions \nmean_sst_rcl <- classify(mean_sst, \n                         rcl = rcl_sst)\n\ndepth_rcl <- classify(depth, \n                      rcl = rcl_depth)\n\n# define our function to multiply values in the two rasters\nrast_multiply <- function(x, y) {\n  (x * y)\n}\n\n# stack the rasters\nsuitability_stack <- c(depth_rcl, mean_sst_rcl)\n\n# multiply each cell in one raster by the corresponding cell in the other raster. Our output should only include locations that satisfy both the depth and SST requirements for oysters\noyster_suitability <- lapp(suitability_stack, fun = rast_multiply)\n```\n:::\n\n\n#### Determine the most suitable areas in each West Coast EEZ\n\nWe want to determine the total suitable area within each EEZ in order to rank zones by priority. To do so, we need to find the total area of suitable locations within each EEZ. We'll select suitable cells within each EEZ and find the total suitable area and percent suitable area within each EEZ. To do this, we'll need to rasterize the EEZ vector data by region, so cells will now be represented by region name.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# rasterize EEZs by region\nregion_rast <- rasterize(wc_eez, depth, field = \"rgn\")\n\n# find area of cells in each region\nareas <- expanse(oyster_suitability, unit = \"km\", zones = region_rast)\n\n# join area values to each EEZ\nwc_eez_merge <- merge(wc_eez, areas, \n                      by.x = \"rgn\", \n                      by.y = \"zone\",\n                      all.x = TRUE) %>% \n  mutate(p_area = (area/area_km2) * 100) # find the percentage suitable area in each region\n```\n:::\n\n\n#### Visualize results\n\nNow that we have results, let's map them. We'll create two maps: one showing the percent suitable area in each EEZ, and one showing the total suitable area in each EEZ.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## map percent suitable area for oyster aquaculture in each EEZ\n# load in World data from tmap for our basemap \ndata(\"World\")\nbasemap <- tm_shape(World, bbox = st_bbox(wc_eez_merge)) +\n  tm_polygons(col = \"lightgray\",\n              lwd = 0)\n  \n# map the percent suitable area over our basemap\noyster_percent_area <- basemap +\n  tm_shape(wc_eez_merge) +\n  tm_polygons(col = \"p_area\", # color polygons by percent area\n              palette = \"Greens\",\n              title = \"percent suitable area\",\n              style = \"cont\") + # make the legend graphics continous \n  tm_layout(main.title = \"Oyster Aquaculture Suitability\",\n            legend.outside = TRUE,\n            legend.frame = TRUE) +\n  tm_add_legend(type = \"fill\", # manually add legend symbol for EEZs\n                border.col = \"black\",\n                title = \"\",\n                labels = c(\"exclusive economic zone\"),\n                col = \"transparent\") +\n  tm_compass(position = c(-.05, .1)) +\n  tm_scale_bar(position = c(0.02, 0),\n               breaks = c(0, 100, 200, 300)) # change scale bar breaks\n\n# save the map output\ntmap_save(oyster_percent_area, filename = here(\"images\", \"oyster_percent_area_map.png\"), width = 10, height = 8, units = \"in\", dpi = 300)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nMap saved to /Users/charliecurtin 1/Documents/MEDS/personal_school_docs/charliecurtin1.github.io/images/oyster_percent_area_map.png\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nResolution: 3000 by 2400 pixels\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nSize: 10 by 8 inches (300 dpi)\n```\n:::\n\n```{.r .cell-code}\n# view the map\noyster_percent_area\n```\n\n::: {.cell-output-display}\n![](aquaculture-suitability-CA_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# map total suitable area for aquaculture in each EEZ\noyster_suitable_area <- basemap +\n  tm_shape(wc_eez_merge) +\n  tm_polygons(col = \"area\", # color polygons by total suitable area\n              palette = \"Greens\",\n              title = expression(paste(\"total suitable area (\", \"km\"^\"2\", \")\"))) + # changes legend title and adds the superscript to \"km\"\n  tm_layout(main.title = \"Oyster Aquaculture Suitability\",\n            legend.outside = TRUE,\n            legend.frame = TRUE) +\n  tm_add_legend(type = \"fill\", # manually add legend symbol for EEZs\n                border.col = \"black\",\n                title = \"\",\n                labels = c(\"exclusive economic zone\"),\n                col = \"transparent\") +\n  tm_compass(position = c(-.05, .1)) +\n  tm_scale_bar(position = c(0.02, 0),\n               breaks = c(0, 100, 200, 300)) # change scale bar breaks\n\n# save the map output\ntmap_save(oyster_suitable_area, filename = here(\"images\", \"oyster_suitable_area_map.png\"), width = 10, height = 8, units = \"in\", dpi = 300)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nMap saved to /Users/charliecurtin 1/Documents/MEDS/personal_school_docs/charliecurtin1.github.io/images/oyster_suitable_area_map.png\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nResolution: 3000 by 2400 pixels\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nSize: 10 by 8 inches (300 dpi)\n```\n:::\n\n```{.r .cell-code}\n# view the output\noyster_suitable_area\n```\n\n::: {.cell-output-display}\n![](aquaculture-suitability-CA_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n#### Creating a function to input other species\n\nNow that we've developed a workflow to find suitable area for aquaculture for oysters, we can put all the steps together in a function to conduct the same analysis for other species. Our function will take the species name, ideal SST range, and ideal depth range.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## create a function that takes a species and its ideal temperature and depth ranges and returns maps of total suitable area and percent suitable area per EEZ\n\naquaculture_fun <- function(species, temp_low, temp_high, depth_low, depth_high){\n  # define reclassification matrices for SST and depth\n  rcl_sst_fun <- matrix(c(temp_low, temp_high, 1,\n                          -Inf, temp_low, NA,\n                          temp_high, Inf, NA),\n                        ncol = 3,\n                        byrow = TRUE)\n  rcl_depth_fun <- matrix(c(depth_low, depth_high, 1,\n                            -Inf, depth_low, NA,\n                            depth_high, Inf, NA),\n                          ncol = 3,\n                          byrow = TRUE)\n  # reclassify SST and depth rasters for the species of our choice\n  mean_sst_fun <- classify(mean_sst, \n                           rcl = rcl_sst_fun)\n  depth_fun <- classify(depth, \n                        rcl = rcl_depth_fun)\n  # define our function that will multiply cell values between the two rasters\n  rast_multiply <- function(x, y) {\n  (x * y)\n  }\n  # stack our SST and depth rasters\n  stack <- c(mean_sst_fun, depth_fun)\n  # apply our multiplication function to both rasters\n  suitability <- lapp(stack, fun = rast_multiply)\n  # find suitable area in each EEZ\n  areas_fun <- expanse(suitability, unit = \"km\", zones = region_rast)\n  # join suitable area in each region to the regions shapefile\n  wc_eez_fun <- merge(wc_eez, areas_fun, \n                      by.x = \"rgn\", \n                      by.y = \"zone\",\n                      all.x = TRUE) %>% \n    mutate(area = replace_na(area, 0)) %>% # replaces regions with NA with 0 for mapping purposes\n    mutate(p_area = (area/area_km2) * 100)\n  # create a map of percent suitable area by EEZ\n  p_area_map <- basemap +\n    tm_shape(wc_eez_fun) +\n    tm_polygons(col = \"p_area\",\n                palette = \"Greens\",\n                title = \"percent suitable area\",\n                style = \"cont\") +\n    tm_layout(main.title = paste(species, \"\\nAquaculture Suitability\"), # add species input to the main title\n              legend.outside = TRUE,\n              legend.frame = TRUE) +\n    tm_add_legend(type = \"fill\",\n                  border.col = \"black\",\n                  title = \"\",\n                  labels = c(\"exclusive economic zone\"),\n                  col = \"transparent\") +\n    tm_compass(position = c(-.05, .1)) +\n    tm_scale_bar(position = c(0.02, 0),\n                 breaks = c(0, 100, 200, 300))\n  # create a map of total suitable area by EEZ\n  area_map <- basemap +\n    tm_shape(wc_eez_fun) +\n    tm_polygons(col = \"area\",\n                palette = \"Blues\",\n                title = expression(paste(\"total suitable area (\", \"km\"^\"2\", \")\"))) +\n    tm_layout(main.title = paste(species, \"\\nAquaculture Suitability\"),\n              legend.outside = TRUE,\n              legend.frame = TRUE) +\n    tm_add_legend(type = \"fill\",\n                  border.col = \"black\",\n                  title = \"\",\n                  labels = c(\"exclusive economic zone\"),\n                  col = \"transparent\") +\n    tm_compass(position = c(-.05, .1)) +\n    tm_scale_bar(position = c(0.02, 0),\n                 breaks = c(0, 100, 200, 300))\n  # arrange our maps side-by-side\n  tmap_arrange(p_area_map, area_map)\n}\n```\n:::\n\n\nLet's test the function with two different fish - Yellowfin Tuna and White Seabass. Yellowfin Tuna prefer warmer waters (17.8 - 31 degrees Celsius) and occupy the water column from 0 - 100 meters beneath the surface (NOAA). White Seabass can live in a wider range of temperatures (8 - 24 degrees Celsius) and occupy the water column from 0 - 122 meters beneath the surface (California Sea Grant).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# testing the function using Yellowfin Tuna and it's ideal SST and depth ranges\n# ideal SST (Celsius): 17.8-31\n# ideal depth (meters): -100-0\naquaculture_fun(\"Yellowfin Tuna\", 17.8, 31, -100, 0)\n```\n\n::: {.cell-output-display}\n![](aquaculture-suitability-CA_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# testing the funtion using White Seabass and its ideal temperature and depth ranges\n# ideal SST (Celsius): 8-24\n# ideal depth (meters): -122-0\naquaculture_fun(\"White Seabass\", 8, 24, -122, 0)\n```\n\n::: {.cell-output-display}\n![](aquaculture-suitability-CA_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n### References\n\n1.  Hall, S. J., Delaporte, A., Phillips, M. J., Beveridge, M. & O'Keefe, M. Blue Frontiers: Managing the Environmental Costs of Aquaculture (The WorldFish Center, Penang, Malaysia, 2011).\n\n2.  Gentry, R. R., Froehlich, H. E., Grimm, D., Kareiva, P., Parke, M., Rust, M., Gaines, S. D., & Halpern, B. S. Mapping the global potential for marine aquaculture. *Nature Ecology & Evolution*, 1, 1317-1324 (2017).\n\n3.  \"Aquaculture on the West Coast\". NOAA Fisheries. <https://www.fisheries.noaa.gov/west-coast/aquaculture/aquaculture-west-coast>\n",
    "supporting": [
      "aquaculture-suitability-CA_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}